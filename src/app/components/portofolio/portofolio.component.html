<div class="h-full dark:bg-gray-900">
  <header
    class="bg-white shadow dark:bg-gray-800 flex items-center justify-between"
  >
    <div class="px-4">
      <button
        (click)="chartView = !chartView"
        class="text-white bg-primary-600 focus:outline-none font-medium rounded-lg text-sm px-5 py-2.5 text-center bg-gradient-to-r from-green-400 to-blue-500 hover:from-pink-500 hover:to-yellow-500"
      >
       @if (chartView) {Detailed View} @else { Chart View}
      </button>
    </div>
    <div class="max-w-7xl px-4 py-6 sm:px-6 lg:px-8">
      <h1
        class="text-3xl font-bold tracking-tight text-gray-900 dark:text-white"
      >
        Market Cap : {{ marketCap }}
      </h1>
    </div>
    <div class="px-4">
      <button
        (click)="logOut()"
        type="submit"
        class="text-white bg-primary-600 hover:bg-primary-700 focus:ring-4 focus:outline-none focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800 content-center"
      >
        <span>Log</span><span>out</span>
      </button>
    </div>
  </header>

  @if (chartView) {
  <div class="chart">
    <p class="dark:text-white p-6 lg:mx-36 inline-block">
      In mod ideal, pentru a urmari indicele BET, toate ar trebui sa fie pe 0,
      ce este peste inseamna ca e nevoie sa cumperi de acea suma, ce este sub
      inseamna ca ai o detinere prea mare.
    </p>

    @if (loading) {
    <div *ngIf="loading">Loading</div>
    } @else {
    <div class="h-screen lg:mx-6">
      <div class="min-h-full sm:px-6 dark-chart" *ngIf="!loading">
        <ngx-charts-bar-vertical
          [results]="dataset"
          [xAxisLabel]="'x-axis'"
          [legendTitle]="'legend'"
          [yAxisLabel]="'y-axis'"
          [legend]="true"
          [showXAxisLabel]="true"
          [showYAxisLabel]="true"
          [xAxis]="true"
          [yAxis]="true"
          [gradient]="true"
        >
        </ngx-charts-bar-vertical>
      </div>
    </div>
    }
  </div>
  } @else {
  <div class="flex flex-wrap justify-center mt-10">
    @for (stock of detailedSrocks(); track $index) {

    <div
      class="block max-w-sm p-6 bg-white border border-gray-200 rounded-lg shadow hover:bg-gray-100 dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700"
    >
      <h5
        class="mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white break-keep"
      >
        {{ stock.name }}
        <span class="text-lime-500"> {{ stock.symbol }} </span>
      </h5>
      <div class="font-normal text-gray-700 dark:text-gray-400">
        <div>Total : {{ stock.value || 0 | number : '0.0-3' }}</div>
        @if(stock.toBuy! > 0){
        <div class="text-lime-500">
          De cumparat: {{ stock.toBuy | number : '0.0-3' }}
        </div>
        } @else if(stock.toBuy! < 0){
        <div class="text-blue-700">
          Peste: {{ -1 * stock.toBuy! | number : '0.3-3' }}
        </div>
        }
      </div>
    </div>
    }
  </div>
  }

  <p class="dark:text-white p-6 lg:mx-36 inline-block">
    Pentru a face download fisierului .CSV accesati
    <a
      href=" https://portal.tradeville.ro/mytv/mytv.htm"
      target="_blank"
      class="text-lime-500"
    >
      portal.tradeville.ro
    </a>
    la sectiunea Portofoliu -> Optiuni -> Raport CSV.

    <span class="group relative">
      <span class="text-lg font-bold">Hover over me</span>
      <img
        src="assets/img/csv-file.png"
        alt="Your Image"
        class="absolute top-0 left-100 hidden h-auto opacity-0 group-hover:opacity-100 transition-opacity min-w-60rem"
      />
    </span>
  </p>

  <div class="lg:mx-36 pb-20">
    <ngx-file-drop
      dropZoneLabel="Drop files here"
      (onFileDrop)="dropped($event)"
    >
      <ng-template
        ngx-file-drop-content-tmp
        let-openFileSelector="openFileSelector"
      >
        <button type="button" (click)="openFileSelector()">
          Click here to upload csv file from your portofolio.
        </button>
      </ng-template>
    </ngx-file-drop>
  </div>
</div>
